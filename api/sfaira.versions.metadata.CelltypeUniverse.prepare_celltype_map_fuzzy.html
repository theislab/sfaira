

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>sfaira.versions.metadata.CelltypeUniverse.prepare_celltype_map_fuzzy &mdash; sfaira 0+untagged.1.gff3f387 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom_sfaira.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="sfaira.versions.metadata.CelltypeUniverse.prepare_celltype_map_tab" href="sfaira.versions.metadata.CelltypeUniverse.prepare_celltype_map_tab.html" />
    <link rel="prev" title="sfaira.versions.metadata.CelltypeUniverse.load_target_universe" href="sfaira.versions.metadata.CelltypeUniverse.load_target_universe.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> sfaira
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.1.gff3f387
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-sfaira.data">Data: <code class="docutils literal notranslate"><span class="pre">data</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-sfaira.estimators">Estimator classes: <code class="docutils literal notranslate"><span class="pre">estimators</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-sfaira.models">Model classes: <code class="docutils literal notranslate"><span class="pre">models</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-sfaira.train">Train: <code class="docutils literal notranslate"><span class="pre">train</span></code></a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#module-sfaira.versions">Versions: <code class="docutils literal notranslate"><span class="pre">versions</span></code></a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../api.html#genomes">Genomes</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../api.html#metadata">Metadata</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.Ontology.html">sfaira.versions.metadata.Ontology</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologyList.html">sfaira.versions.metadata.OntologyList</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologyHierarchical.html">sfaira.versions.metadata.OntologyHierarchical</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologyObo.html">sfaira.versions.metadata.OntologyObo</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologyOboCustom.html">sfaira.versions.metadata.OntologyOboCustom</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologyCellosaurus.html">sfaira.versions.metadata.OntologyCellosaurus</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologyCl.html">sfaira.versions.metadata.OntologyCl</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologyHsapdv.html">sfaira.versions.metadata.OntologyHsapdv</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologyMondo.html">sfaira.versions.metadata.OntologyMondo</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologyMmusdv.html">sfaira.versions.metadata.OntologyMmusdv</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologySinglecellLibraryConstruction.html">sfaira.versions.metadata.OntologySinglecellLibraryConstruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfaira.versions.metadata.OntologyUberon.html">sfaira.versions.metadata.OntologyUberon</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="sfaira.versions.metadata.CelltypeUniverse.html">sfaira.versions.metadata.CelltypeUniverse</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api.html#topologies">Topologies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-sfaira.ui">User interface: <code class="docutils literal notranslate"><span class="pre">ui</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../commandline_interface.html">Commandline interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adding_datasets.html">Contributing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../consuming_data.html">Consuming Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecosystem.html">Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sfaira</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          



















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../api.html">API</a> &raquo;</li>
        
          <li><a href="sfaira.versions.metadata.CelltypeUniverse.html">sfaira.versions.metadata.CelltypeUniverse</a> &raquo;</li>
        
      <li>sfaira.versions.metadata.CelltypeUniverse.prepare_celltype_map_fuzzy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <!-- User defined GitHub URL -->
              <a href="sfaira.versions.metadata.CelltypeUniverse.prepare_celltype_map_fuzzy" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sfaira-versions-metadata-celltypeuniverse-prepare-celltype-map-fuzzy">
<h1>sfaira.versions.metadata.CelltypeUniverse.prepare_celltype_map_fuzzy<a class="headerlink" href="#sfaira-versions-metadata-celltypeuniverse-prepare-celltype-map-fuzzy" title="Permalink to this headline">¶</a></h1>
<dl class="py method">
<dt class="sig sig-object py" id="sfaira.versions.metadata.CelltypeUniverse.prepare_celltype_map_fuzzy">
<span class="sig-prename descclassname"><span class="pre">CelltypeUniverse.</span></span><span class="sig-name descname"><span class="pre">prepare_celltype_map_fuzzy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_only</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_synonyms</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anatomical_constraint</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choices_for_perfect_match</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omit_list</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><span class="pre">list</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omit_target_list</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><span class="pre">list</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">['cell']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_suggest</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_for_partial_matching</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">90.0</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#sfaira.versions.metadata.CelltypeUniverse.prepare_celltype_map_fuzzy" title="Permalink to this definition">¶</a></dt>
<dd><p>Map free text node names to ontology node names via fuzzy string matching and return as list</p>
<p>If this function does not yield good matches, consider querying this web interface:
<a class="reference external" href="https://www.ebi.ac.uk/ols/index">https://www.ebi.ac.uk/ols/index</a></p>
<p>Search strategies:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>exact_match: Only exact string matches to name or synonym in ontology. This is the only strategy that is</dt><dd><p>enabled if match_only is True.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>lenient_match: Fuzzy string matches to name or synonym in ontology based on ratio of match errors</dt><dd><p>((fuzz.ratio).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>very_lenient_match: Fuzzy string matches to name or synonym in ontology based on ratio of matches</dt><dd><p>characters from query (fuzz.partial_ratio)</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>Search strategies with anatomical constraints:
An anatomic constraint is a name of an anatomical structure that can be mapped to UBERON.</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>anatomic_onotolgy_match:</dt><dd><p>We select cell types expected in this UBERON clade based on the link between CL and UBERON.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>anatomic_string_match:</dt><dd><p>We perform an additional fuzzy string matching with the anatomical structure added to the proposed
label. This is often beneficial because analysts do not always prefix such extension (e.g. pancreatic)
to the free text cell type labels if the entire sample consists only of cells from this anatomical
structure. Note that if the maps from 1) were perfect, this would not be necessary. In practice, we
find this to still recover some hits that are otherwise missed.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>Note that matches are shadowed in lower priorty strategies, ie a perfect match will not show up in the list
of hits of any other strategy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – Free text node labels which are to be matched to ontology nodes.</p></li>
<li><p><strong>match_only</strong> – Whether to include strict matches only in output.</p></li>
<li><p><strong>include_synonyms</strong> – Whether to include synonyms of nodes in string search.</p></li>
<li><p><strong>anatomical_constraint</strong> – Whether to require suggestions to be within a target anatomy defined
within UBERON.</p></li>
<li><p><strong>choices_for_perfect_match</strong> – Whether to give additional matches if a perfect match was found and an
anatomical_constraint is not not defined. This is overridden by match_only.</p></li>
<li><p><strong>omit_list</strong> – Free text node labels to omit in map.</p></li>
<li><p><strong>omit_target_list</strong> – Ontology nodes to not match to.</p></li>
<li><p><strong>n_suggest</strong> – Number of cell types to suggest per search strategy.</p></li>
<li><p><strong>threshold_for_partial_matching</strong> – Maximum fuzzy match score below which lenient matching (ratio) is
extended through partial_ratio.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple</p>
<ul class="simple">
<li><dl class="simple">
<dt>List with matches for each source, each entry is a dictionary,</dt><dd><p>of lists of search strategies named by strategy name. If a search strategy yields perfect matches, it
does not return a list of strings but just a single string.</p>
</dd>
</dl>
</li>
<li><p>List with boolean indicator whether or not this output should be reported.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="sfaira.versions.metadata.CelltypeUniverse.prepare_celltype_map_tab.html" class="btn btn-neutral float-right" title="sfaira.versions.metadata.CelltypeUniverse.prepare_celltype_map_tab" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="sfaira.versions.metadata.CelltypeUniverse.load_target_universe.html" class="btn btn-neutral float-left" title="sfaira.versions.metadata.CelltypeUniverse.load_target_universe" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Leander Dony, David S. Fischer, Lukas Heumos..

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>